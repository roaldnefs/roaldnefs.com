<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://roaldnefs.com/css/theme.min.css">

    <link rel="apple-touch-icon" sizes="180x180" href="https://roaldnefs.com/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://roaldnefs.com/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://roaldnefs.com/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://roaldnefs.com/favicon/site.webmanifest">

    <title>Hardware Reversing the Sitecom Wireless Router 150N X1 &ndash; Roald Nefs</title>

    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500&family=Open+Sans:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    
</head><body class="text-dark"><nav class="navbar navbar-expand-lg navbar-light">
    <div class="container">
        <a class="navbar-brand" href="https://roaldnefs.com/">roald<strong>nefs</strong>.com</a>

        <div class="justify-content-between">

            
            
            <ul class="list-unstyled list-inline meta meta-nav text-uppercase">
                
                <li class="list-inline-item">
                    <a class="nav-link" href="https://roaldnefs.com/posts/">Articles</a>
                </li>
                
                <li class="list-inline-item">
                    <a class="nav-link" href="https://roaldnefs.com/authors/roald-nefs/">About</a>
                </li>
                
            </ul>
            
        </div>
    </div>
</nav>
<div class="container p-3 p-lg-5">
    <div class="row">
        <aside id="meta" class="col col-12 col-lg-3 order-2 order-lg-1 p-3 p-lg-0">
            
                
                
                
                    <div class="pb-2">
                        <img src="/images/authors/roald-nefs.jpg" class="img-author" alt="Roald Nefs">
                    </div>
                    <span><a href="/authors/roald-nefs" class="text-decoration-none text-dark">Roald Nefs</a></span>
                    <p class="pt-2 pe-lg-2 small">Roald is an IT consultant at Warpnet B.V. with over five years of Security and Site Reliability Engineering (SRE) experience at various companies like DUO, KPN and CJIB. He has made several contributions to open source, to tools such as SaltStack, Prometheus, rfcat and many more. Roald enjoys tinkering with electronics, hardware hacking, software development and dogsport.
</p>
                
            
        </aside>
        <div class="col col-12 col-lg-9 order-1 order-lg-2">
            <h1>Hardware Reversing the Sitecom Wireless Router 150N X1</h1>
            <span class="small"><strong>December 15, 2019</strong></span>

            <article id="content">
                <p>Last week I&rsquo;ve bought a Rigol DS1102E digital oscilloscope and was very eager to test it out. When going to my bin of old hardware I&rsquo;ve found a Sitecom Wireless Router 150N X1. After opening up the router I immediately spotted the UART debugging interface (<em>top left in the picture</em>). In this post we will go through the process of connecting to an unknown serial interface.</p>
<p><img src="/images/posts/2019/12/15/sitecom_01.jpg" alt="Inside of the Sitecom Wireless Router 150N X1"></p>
<p>The UART debugging interface wasn&rsquo;t labeled, so I had to figure out what each port was doing. The two pins on the right are directly connected to the IC, so I figured that those to are the <strong>RX</strong> and <strong>TX</strong> ports. By connecting a multi meter to the two left most pins I&rsquo;ve found that the serial port is using <strong>3.3V</strong> and the left most connector is the <strong>VCC</strong> followed by the <strong>GND</strong> pin. By connecting the ground lead of the multi meter to <strong>GND</strong> pin on the serial interface I quickly spotted <strong>RX</strong> port (<em>positive voltage</em>). From left to right the pins are: <strong>VCC</strong>, <strong>GND</strong>, <strong>TX</strong> and <strong>RX</strong>.</p>
<p><img src="/images/posts/2019/12/15/sitecom_02.jpg" alt="Determining the pins on the serial interface using a multimeter"></p>
<p>We now know the operating voltage and pin layout of the serial interface but the baud rate is still unknown, so I&rsquo;ve connected my new oscilloscope to the <strong>GND</strong> and <strong>TX</strong> pins on the serial interface and set it to trigger on a pulse. After power cycling the router is saw the following signal:</p>
<p><img src="/images/posts/2019/12/15/sitecom_03.jpg" alt="Inspecting the serial connection using a oscilloscope"></p>
<p>By determining the length of the shortest pulse I was able to figure out the baud rate using the following formula: <code>1 / time * 106</code>, in my case: <code>1 / (886µs / 870µs) * 106 = 62500</code>. But this isn&rsquo;t a usual baud rate, so I took once that was closest to 62500: <strong>57600</strong>.</p>
<p><img src="/images/posts/2019/12/15/sitecom_04.jpg" alt="Inspecting length of the shortest pulse using a oscilloscope"></p>
<p>The USB to TTL module (<em>PL2303</em>) I had laying around operated on <strong>5V</strong>, because I was not willing to risk breaking the router I had to down convert to voltage to <strong>3.3V</strong>. This can be done using a <a href="https://www.sparkfun.com/products/12009">bi-directional logic level converter</a>.</p>
<p><img src="/images/posts/2019/12/15/sitecom_05.jpg" alt="Connecting the serial interface to the laptop using a logic level converter"></p>
<p>Using the USB to serial connection we are able to connect to the router using minicom with the following command: <code>minicom -b 57600 -8 -D /dev/ttyUSB0</code>. After power cycling the router, the following output appears:</p>
<p><img src="/images/posts/2019/12/15/sitecom_06.png" alt="Serial console on the Sitecom Wireless Router 150N X1"></p>
<p>According the the boot log the Sitecom Wireless Router 150N X1 is using Linux!</p>

            </article>

            <hr>
        </div>
    </div>
    <div class="row">
        <div class="col col-lg-9 offset-lg-3">
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "roaldnefs" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </div>
</div>

<footer class="container py-4">
    <div class="row">
        <div class="col-lg-4 pb-2">
            <p class="meta">
              Roald Nefs, security specialist and open-source contributor<br />
              Copyright &copy 2019-2024. All Rights Reserved.
            </p>
        </div>
        <div class="col-lg-2 col-sm-3 pb-2 pb-sm-0">
            <ul class="list-unstyled text-uppercase meta">
                <li>
                    <a href="https://github.com/roaldnefs">gh/roaldnefs</a>
                </li>
                <li>
                    <a href="https://twitter.com/roaldnefs">tw/roaldnefs</a>
                </li>
                <li>
                    <a href="https://linkedin.com/in/roaldnefs">in/roaldnefs</a>
                </li>
                <li>
                    <a href="https://www.working-dog.com/user/Roald-Nefs-537970">wd/roald-nefs-537970</a>
                </li>
            </ul>
        </div>
        <div class="col-lg-1 col-sm-3 pb-2 pb-sm-0">
            <ul class="list-unstyled text-uppercase meta">
                <li>
                    <a href="https://roaldnefs.com/posts/index.xml">RSS</a>
                </li>
                <li>
                    <a href="https://roaldnefs.com/posts/">Posts</a>
                </li>
            </ul>
        </div>
        <div class="col-lg-1 col-sm-3">
            <ul class="list-unstyled text-uppercase meta">
                <li>
                    <a href="https://roaldnefs.com/"><strong>Home</strong></a>
                </li>
            </ul>
        </div>
    </div>
</footer><script src="https://roaldnefs.com/js/popper.min.js"></script>
<script src="https://roaldnefs.com/js/bootstrap.min.js"></script>
</body>
</html>