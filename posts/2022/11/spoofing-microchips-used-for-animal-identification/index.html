<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://roaldnefs.com/css/theme.min.css">

    <link rel="apple-touch-icon" sizes="180x180" href="https://roaldnefs.com/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://roaldnefs.com/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://roaldnefs.com/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://roaldnefs.com/favicon/site.webmanifest">

    <title>Spoofing Microchips used for Animal Identification &ndash; Roald Nefs</title>

    
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;1,400;1,600&family=Source+Sans+Pro:wght@300;400&display=swap" rel="stylesheet">
</head><body class="bg-gray text-dark"><nav class="navbar navbar-expand-lg navbar-light">
    <div class="container">
        <a class="navbar-brand" href="https://roaldnefs.com/">roald<strong>nefs</strong>.com</a>

        <div class="justify-content-between">

            
            
            <ul class="list-unstyled list-inline meta meta-nav text-uppercase">
                
                <li class="list-inline-item">
                    <a class="nav-link" href="https://roaldnefs.com/">Home</a>
                </li>
                
                <li class="list-inline-item">
                    <a class="nav-link" href="https://roaldnefs.com/posts/">Posts</a>
                </li>
                
            </ul>
            
        </div>
    </div>
</nav>

<article class="container bg-white p-3 p-lg-5">
    <div class="row">
        <div class="col">
            <h1>Spoofing Microchips used for Animal Identification</h1>

            <p>A microchip implanted under the skin of an animal can be used for identification purposes. The microchips are using Radio Frequency Identification (RFID) technology to transmit an unique tag number using an electromagnetic field when in close contact with an nearby RFID reader device. The microchips are often used to help return lost pets quickly. The unique chip numbers are registered in a designated portal to let animal shelters, animal control officers and veterinarians to look up contact information of the animal&rsquo;s owner. During animal trials and events the microchips are often used to verify the animals identity.</p>
<p>This post will demonstrate how an attacker can create an “authentic” microchip by writing properly formatted data on blank or rewritable transponder, also known as spoofing. Unfortunately, the RFID reader devices do not differentiate between the authentic and spoofed microchips. The main intention behind this post is to encourage more secure ways of identifying animals instead of solely trusting the implanted microchip.</p>
<h2 id="introduction-to-fdx-b">Introduction to FDX-B</h2>
<p>FDX-B is a protocol used as a common format for transponders. The protocol is fully described in ISO 11784 and ISO 11785. The transponders operate in the 134.2kHz band and use a biphase encoding scheme to transmit the data.</p>
<p><img src="/images/posts/2022/11/30/microchip-3.png" alt="Example of a biphase encoded signal"></p>
<p>The power used for transmitting data is drawn from the electromagnetic field transmitted by the RFID reader when in close contact with the transponder. The transponders can carry up to 128 bits of data. The table below shows the example of the decoded FDX-B data in bits for the tag number 528140000795552.</p>
<p><img src="/images/posts/2022/11/30/microchip-1.png" alt="Decoded FDX-B data in bits for tag number 528140000795552"></p>
<p>The data is structured according to the FDX-B protocol and will be transmitted with the least significant bit first (lsb). The 11 bit header is used to indicate the beginning of the data block. A logic 1 bit is sent after every 8 bits to differentiate the data from the header. The header is followed by the 38 bit national code, which corresponds to a 12 digit decimal code to uniquely identify an animal. This is followed by the 10 bit, 3 decimal digits, country code (e.g. 528 for the Netherlands). The next application identicator bit indicates whether the 24 extra application data bits are used at the end of the block. The 14 bits followed after the application identicator bit are reserved for future use. The next bit is the animal application identicator. When the transponder is used for animal identification purposes this bit is set to 1. To be able to verify the data block, a 16 bit checksum is calculated according to the ISO 11784 &amp; 11785 standards.</p>
<h2 id="buying-rewritable-fdx-b-microchips-and-programmers">Buying (re)writable FDX-B microchips and programmers</h2>
<p>Although some countries regulate who can buy, implant and register microchips it’s still possible to buy micropships as an individual. In the Netherlands for example, only registered microchippers and veterinarians are allowed to microchip dogs and register the microchip numbers at a designated portal<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. However it’s still possible for non-registered microchippers to find and buy (re)writable ICAR certificated FDX-B microchips online as shown by the advert in the figure below.</p>
<p><img src="/images/posts/2022/11/30/microchip-4.png" alt="Online advert of rewritable FDX-B transponders"></p>
<p>The rewritable microchips often come with a preprogrammed tag number that still needs to be overwritten in order to spoof an authentic number, this can be done using a so called programmer. The RFID programmers often come included with the required software to write properly formatted data to the transponders. The figures below show two programmers which can be used to write valid FDX-B microchips. The Proxmark 3 device even allows the user to simulate a microchip.</p>
<p><img src="/images/posts/2022/11/30/microchip-5.png" alt="Online adverts of programmers which can be used for FDX-B transponders"></p>
<p>As shown by the example adverts in the figures above the total cost of spoofing a microchip including the required programmer and shipping is just around €50. The attacker will only need a single programmer to spoof additional microchips, lowering the cost per spoofed microchip even more.</p>
<h2 id="spoofing-a-fdx-b-microchip">Spoofing a FDX-B microchip</h2>
<p>The examples below will show how a custom chip number can be written to a (re)writable transponder and allow it to be scanned as an authentic microchip using a RFID reader. This example uses a Proxmark 3 programmer to write the properly formatted data on the transponder. For example, the command for writing tag number 528140000795552 to the transponder:</p>
<pre><code>pm3 &gt; lf fdxb clone --em --country 528 --national 140000795552 --animal
</code></pre><p>After writing the data to the rewritable transponder it can also be read by the Proxmark 3 to verify whether the write command was successful. The example command below shows the formatted data after writing the tag number to the transponder:</p>
<pre><code>pm3 &gt; lf fdxb reader
[+] FDX-B / ISO 11784/5 Animal
[+] Animal ID          528-140000795552
[+] National Code      140000795552 (0x2098B29BA0)
[+] Country Code       528 - Kingdom of the Netherlands
[+] Reserved/RFU       0 (0x0000)
[+]   Animal bit set?  True
[+]       Data block?  False  [value 0x0]
[+]         RUDI bit?  False
[+]        User Info?  0 (RFU)
[+]   Replacement No?  0 (RFU)
[+] CRC-16             0xF283 (ok)
[+] Raw                05 D9 4D 19 04 21 00 01
</code></pre><p>When scanning the spoofed microchip using a common RFID reader device it shows as an authentic microchip. By writing the extended/application data using the <code>--extended</code> flag some readers will even be showing the spoofed microchip temperature.</p>
<p><img src="/images/posts/2022/11/30/microchip-2.jpeg" alt="Spoofed microchip being scanned by a RFID reader device"></p>
<p>The above figure shows the spoofed microchip with tag number 528140000795552 being scanned by a RFID reader device. The reader acts as if it is an authentic microchip, to make the user believe that this must actually be the dog with this particular chip number.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Although microchips might help return lost pets more quickly, they should not be solely trusted to verify the animals identity. An attacker can create an “authentic” microchip by writing properly formatted data on blank or rewritable transponder, also known as spoofing. Unfortunately, the RFID reader devices do not differentiate between the authentic and spoofed microchips.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://business.gov.nl/regulation/registering-dogs-and-pet-passports/">https://business.gov.nl/regulation/registering-dogs-and-pet-passports/</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

        </div>
    </div>
    <div class="row">
        <div class="col">
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "roaldnefs" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </div>
</article>

<footer class="container py-4">
    <div class="row">
        <div class="col-lg-4 offset-lg-1 offset-md-2 offset-sm-1 pb-2">
            <p class="meta">
              Roald Nefs, SRE/DevOps engineer and open-source contributor<br />
              Copyright &copy 2019-2022 Roald Nefs. All Rights Reserved.
            </p>
        </div>
        <div class="col-lg-2 col-sm-3 offset-md-2 offset-sm-1 pb-2 pb-sm-0">
            <ul class="list-unstyled text-uppercase meta">
                <li>
                    <a href="https://github.com/roaldnefs">gh/roaldnefs</a>
                </li>
                <li>
                    <a href="https://twitter.com/roaldnefs">tw/roaldnefs</a>
                </li>
                <li>
                    <a href="https://linkedin.com/in/roaldnefs">in/roaldnefs</a>
                </li>
                <li>
                    <a href="https://www.working-dog.com/user/Roald-Nefs-537970">wd/roald-nefs-537970</a>
                </li>
            </ul>
        </div>
        <div class="col-lg-1 col-sm-3 pb-2 pb-sm-0">
            <ul class="list-unstyled text-uppercase meta">
                <li>
                    <a href="https://roaldnefs.com/posts/index.xml">RSS</a>
                </li>
                <li>
                    <a href="https://roaldnefs.com/posts/">Posts</a>
                </li>
            </ul>
        </div>
        <div class="col-lg-1 col-sm-3">
            <ul class="list-unstyled text-uppercase meta">
                <li>
                    <a href="https://roaldnefs.com/"><strong>Home</strong></a>
                </li>
            </ul>
        </div>
    </div>
</footer><script src="https://roaldnefs.com/js/popper.min.js"></script>
<script src="https://roaldnefs.com/js/bootstrap.min.js"></script>
</body>
</html>