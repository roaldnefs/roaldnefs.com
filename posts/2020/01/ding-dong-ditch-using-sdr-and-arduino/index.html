<!DOCTYPE html>
<html><head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    
    <link rel="stylesheet" href="https://roaldnefs.com/css/theme.min.css">

    <title>Roald Nefs</title>
</head><body class="bg-light"><nav class="navbar navbar-expand-lg navbar-light">
    <div class="container">
        <a class="navbar-brand" href="https://roaldnefs.com/">roald<strong>nefs</strong>.com</a>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#primaryMenu" aria-controls="primaryMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse justify-content-between" id="primaryMenu">

            
            
            <ul class="navbar-nav mr-auto">
                
                <li class="nav-item">
                <a class="nav-link" href="https://roaldnefs.com/posts/">Posts</a>
                </li>
                
            </ul>
            
            <ul class="navbar-nav ml-auto flex-row">
                <li class="nav-item">
                    <a href="https://roaldnefs.com//posts/index.xml" class="nav-link">
                        <svg
                            width="1.5rem"
                            height="1.5rem"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                        >
                            <use xlink:href="https://roaldnefs.com//images/icons/feather-sprite.svg#rss"/>
                        </svg>
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<article class="container">
    <div class="row">
        <div class="col">
            <h1>Ding Dong Ditch using SDR and Arduino</h1>

            <p>In this post we will be building a device to play Ding Dong Ditch  digitally. The device will ring the doorbell every several seconds  without pressing the button. This project is all about reverse  engineering radio frequencies using a RLT-SDR and creating hardware  using an Arduino.</p>
<p>This project is heavily based upon the <a href="https://samy.pl/dingdong/">Digital Ding Dong Ditch</a> by <a href="https://samy.pl/">Samy Kamkar</a>.</p>
<p>The video is a short demonstration of the Ding Dong Ditch device.  Once it’s powered by USB (or a battery) it will send out a RF signal  every few seconds which will ring the doorbell.</p>
<h2 id="requirements">Requirements</h2>
<p>For this project you will need several tools and modules to record and send the signal.</p>
<h3 id="hardware">Hardware</h3>
<p><strong>RTL-SDR:</strong> The RTL-SDR is an inexpensive software  defined radio using a Realtek chip. The dongle can be used to receive a  wide range of frequencies, including those of some wireless doorbells.</p>
<p><strong>Arduino:</strong> In this post I will be using an Arduino Nano clone. Arduino is a great platform for cheap and rapid creation of hardware.</p>
<p><strong>433MHz ASK RF Transmitter:</strong> For sending the RF signal  I will be using a FS1000A (433MHz) RF transmitter. You might want to  locate your frequency first, before buying a transmitter for a specific  frequency.</p>
<h3 id="software">Software</h3>
<p><strong>RTL-SDR &amp; GQRX:</strong> RTL-SDR and Gqrx will be used to  locate, record and visualise the radio signal. Instruction about  installing RTL-SDR and Gqrx on Linux can be found in Software Defined Radio on Linux post.</p>
<p><strong>Audacity:</strong> Audacity is used for taking a closer look at the radio signal in order to demodulate it by hand.</p>
<p><strong>Ding Dong Ditch:</strong> The Arduino sketch for this project can be found at my GitHub: <a href="https://github.com/roaldnefs/ding-dong-ditch">github.com/roaldnefs/ding-dong-ditch</a>.</p>
<h2 id="locate-the-signal">Locate the Signal</h2>
<p>We will start by locating the signal send when pressing the doorbell  button. On most devices you will find the frequency on the device  itself. In my case the doorbell receiver clearly states that it uses the  433MHz frequency:</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_01.png" alt="Select Plus doorbell sticker"></p>
<p>Using Gqrx with the RTL-SDR connected to your computer, you will be able to spot signal while pressing the doorbell button.</p>
<p>If you aren’t able to locate the frequency of your doorbell (<em>or you simple cannot find the doorbell receiver</em>),  you can always keep pressing the doorbell while you scroll through the  spectrum in Gqrx. You might want to check the 315MHz, 433MHz and 900MHz  bands first, because they are among the most frequently used bands.</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_02.jpg" alt="Doorbell signal in Gqrx"></p>
<p>I was able to locate my doorbell signal on <strong>433.879MHz</strong>.</p>
<h2 id="recording-and-demodulating-the-signal">Recording and Demodulating the Signal</h2>
<p>Modulation allow data to be transmitted via radio via radio  frequencies. After locating the signal you’ll need to determine the type  of modulation used by the doorbell. By looking at the waterfall in Gqrx  I was able to determine that the signal send by the doorbell is  amplitude modulated. The most common modulation schemes you will see in  radio are:</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Amplitude_modulation">Amplitude Modulation</a> (AM)</li>
<li><a href="http://en.wikipedia.org/wiki/Frequency_modulation">Frequency Modulation</a> (FM)</li>
<li><a href="http://en.wikipedia.org/wiki/Phase_modulation">Phase Modulation</a> (PM)</li>
</ul>
<p>Amplitude modulation, as the name might suggest, modulates the  amplitude while frequency modulation will modulate the frequency. If you  are listing to 100.0 FM radio, the signal is actually send between  99.995MHz and 100.005MHz.</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_03.gif" alt="Modulation"></p>
<p>By the looks of it, the signal seems to be using amplitude  modulation. Using rtl_fm and sox you can record the AM data into a wav file:</p>
<pre><code class="language-console" data-lang="console">rtl_fm -M am -f 433879000 -s 2000000 - | sox -t raw -r 2000000 -e signed-integer -b 16 -c 1 -V1 - doorbell.wav
</code></pre><p>Since we are dealing with digital information (1s and 0s) the modulation will be more discrete than just AM, common schemes are:</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/Amplitude-shift_keying">Amplitude Shift Keying</a> (ASK)</li>
<li><a href="http://en.wikipedia.org/wiki/Frequency-shift_keying">Frequency Shift Keying</a> (FSK)</li>
<li><a href="http://en.wikipedia.org/wiki/Phase-shift_keying">Phase Shift Keying</a> (PSK)</li>
</ul>
<p>When looking at the audio in Audacity it appears to be sending the same signal multiple times in a row.</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_04.png" alt="Recorded signal in Audacity"></p>
<p>If we zoom in to take a closer look at the signal, we can easily see the highs (1s) and lows (0s).</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_04.png" alt="Closer look at the recorded signal in Audacity"></p>
<p>The high and low signals aren’t appearing to be the same length, but the two same patterns keep reappearing:</p>
<ul>
<li><code>﹍|﹉﹉|</code>, the high signal seems to be twice as long as the low signal</li>
<li><code>﹍﹍|﹉|</code>, the low signal seems to be twice as long as the high signal</li>
</ul>
<p>This is something called <a href="https://en.wikipedia.org/wiki/Pulse-width_modulation">Pulse Width Modulation</a> (PWM). If we interpret the first signal as a 1 and the second signal as a 0, then we will end up with something like this:</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_06.jpg" alt="Signal demodulated by hand"></p>
<p>You might want to check multiple samples because the signal isn’t  very clear on some spots. Examples of a 1 and 0 signal are shown below:</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_07.png" alt="Signal in Audacity"></p>
<p>You will be able to get the same result much faster using <a href="https://github.com/merbanan/rtl_433">rtl_433</a>.  It might be a good idea to verify you manually demodulated signal using  rtl_433 before creating the Arduino. In my case it guesses the  modulation type to be Pulse Width Modulation, after demodulation using  rtl_433 I end up with the same 1s and 0s as I’ve found manually.</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_08.png" alt="Signal demodulated by rtl_433"></p>
<h2 id="creating-the-arduino">Creating the Arduino</h2>
<p>For sending signal we demodulated earlier, I’m using a 433MHz ASK  transmitter hooked up to my Arduino nano clone according to the  following Fritzing sketch:</p>
<p><img src="/images/posts/2020/01/03/ding-dong-ditch_09.png" alt="Arduino schematic"></p>
<p>The script for the Arduino can be found on the following GitHub repository: <a href="https://github.com/roaldnefs/ding-dong-ditch">github.com/roaldnefs/ding-dong-ditch</a>. It uses the <a href="https://github.com/sui77/rc-switch.git">RCSwitch</a> library for sending the signal. This library is written for power outlet sockets but my doorbell uses the same protocol.</p>
<p>Once the Arduino is powered over USB or by battery, the doorbell should start ringing!</p>

        </div>
    </div>
    <div class="row">
        <div class="col">
            <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "roaldnefs" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
    </div>
</article>

<footer class="container py-4">
    <div class="row">
        <div class="col">
            <a class="brand" href="https://roaldnefs.com/">roald<strong>nefs</strong>.com</a>
            <p class="text-muted pt-2"><small>&copy 2020-present Roald Nefs. All Rights Reserved.</small></p>
        </div>
    </div>
</footer><script src="https://roaldnefs.com/js/jquery.min.js"></script>
<script src="https://roaldnefs.com/js/bootstrap.min.js"></script>
</body>
</html>